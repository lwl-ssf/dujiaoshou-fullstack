<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.dujiaoshou.mapper.OrderMapper">

  <resultMap id="OrderMap" type="com.example.dujiaoshou.entity.Order">
    <id property="id" column="id"/>
    <result property="sn" column="sn"/>
    <result property="status" column="status"/>
    <result property="amount" column="amount"/>
    <result property="currency" column="currency"/>
    <result property="paymentChannel" column="payment_channel"/>
    <result property="createdAt" column="created_at"/>
    <result property="paidAt" column="paid_at"/>
    <result property="deliveredAt" column="delivered_at"/>
  </resultMap>

  <insert id="insert" parameterType="com.example.dujiaoshou.entity.Order" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO orders(sn, status, amount, currency, payment_channel, created_at)
    VALUES(#{sn}, #{status}, #{amount}, #{currency}, #{paymentChannel}, #{createdAt})
  </insert>

  <update id="update" parameterType="com.example.dujiaoshou.entity.Order">
    UPDATE orders SET status=#{status}, amount=#{amount}, currency=#{currency},
      payment_channel=#{paymentChannel}, created_at=#{createdAt}, paid_at=#{paidAt}, delivered_at=#{deliveredAt}
    WHERE id=#{id}
  </update>

  <select id="findBySn" resultMap="OrderMap">SELECT * FROM orders WHERE sn=#{sn}</select>
  <select id="findBySnForUpdate" resultMap="OrderMap">SELECT * FROM orders WHERE sn=#{sn} FOR UPDATE</select>
  <select id="selectAll" resultMap="OrderMap">SELECT * FROM orders ORDER BY id DESC</select>
</mapper>
